<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Work Time Calculator</title>
    <style>
        :root {
            /* Custom Theme Variables */
            --primary-color: #1a237e;
            --primary-light: #3949ab;
            --primary-dark: #283593;
            --secondary-color: #388e3c;
            --secondary-light: #4caf50;
            --secondary-dark: #2e7d32;
            --accent-color: #ff9800;
            --accent-light: #ffb74d;
            --accent-dark: #f57c00;
            --background-color: #f4f6f8;
            --card-background: #fff;
            --text-primary: #263238;
            --text-secondary: #374151;
            --border-color: #e3e6ee;
            --shadow-light: rgba(26,35,126,0.06);
            --shadow-medium: rgba(0,0,0,0.1);
            --shadow-heavy: rgba(0,0,0,0.15);
            
            /* Animation Variables */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
            --bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        /* Theme Classes */
        .theme-corporate {
            --primary-color: #1976d2;
            --primary-light: #42a5f5;
            --primary-dark: #1565c0;
            --secondary-color: #388e3c;
        }

        .theme-modern {
            --primary-color: #6200ea;
            --primary-light: #7c4dff;
            --primary-dark: #3700b3;
            --secondary-color: #00c853;
        }

        .theme-warm {
            --primary-color: #d84315;
            --primary-light: #ff7043;
            --primary-dark: #bf360c;
            --secondary-color: #ff8f00;
        }

        /* Loading Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* Loading States */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: slideIn 1.5s infinite;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* Enhanced Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        .slide-in {
            animation: slideIn 0.5s ease-out;
        }

        .bounce-in {
            animation: bounce 0.6s var(--bounce);
        }

        /* Mobile-First Responsive Design */
        @media (max-width: 768px) {
            :root {
                --card-padding: 16px;
                --gap-size: 16px;
            }
            .main {
                max-width: 100%;
                margin: 20px auto 0 auto;
                padding: 0 16px;
            }
            .card {
                padding: 16px;
                border-radius: 12px;
            }
            .header {
                padding: 16px 0 6px 0;
                font-size: 1.5rem;
            }
            .theme-switcher {
                width: 36px;
                height: 36px;
            }
            button {
                padding: 14px 0;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            :root {
                --card-padding: 12px;
                --gap-size: 12px;
            }
            .main {
                padding: 0 12px;
                margin: 16px auto 0 auto;
            }
            .card {
                padding: 12px;
                border-radius: 10px;
            }
            .header {
                padding: 14px 0 4px 0;
                font-size: 1.3rem;
            }
            .header-logo {
                height: 32px;
                width: 32px;
            }
            .theme-switcher {
                width: 32px;
                height: 32px;
                left: 12px;
            }
            .header-credit {
                right: 12px;
                font-size: 0.7rem;
            }
            button {
                padding: 12px 0;
                font-size: 0.95rem;
            }
            .card-title {
                font-size: 1.1rem;
            }
        }

        /* Touch-friendly interactions for mobile */
        @media (hover: none) and (pointer: coarse) {
            button:hover {
                transform: none;
                box-shadow: 0 2px 8px var(--shadow-medium);
            }
            .card:hover {
                transform: none;
                box-shadow: 0 2px 12px var(--shadow-light);
            }
            .calendar-day:hover {
                transform: none;
                box-shadow: 0 1px 3px var(--shadow-medium);
            }
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: var(--background-color);
            margin: 0;
            padding: 0;
            color: var(--text-primary);
            transition: background-color var(--transition-normal);
        }
        .header {
            width: 100%;
            background: var(--primary-color);
            color: #fff;
            padding: 18px 0 8px 0;
            text-align: center;
            font-size: 1.7rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px var(--shadow-light);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: background-color var(--transition-normal);
        }
        .header-logo {
            height: 40px;
            width: 40px;
            margin-right: 14px;
            border-radius: 8px;
            background: #fff;
            padding: 3px;
            box-shadow: 0 1px 4px var(--shadow-medium);
            transition: transform var(--transition-fast);
        }
        .header-logo:hover {
            transform: scale(1.05);
        }
        .header-credit {
            position: absolute;
            right: 18px;
            bottom: 6px;
            font-size: 0.75rem;
            font-weight: 400;
            color: #c5cae9;
            letter-spacing: 0.5px;
            transition: color var(--transition-fast);
        }
        .theme-switcher {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            transition: all var(--transition-fast);
            backdrop-filter: blur(10px);
        }
        .theme-switcher:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-50%) scale(1.1);
        }
        .theme-switcher:active {
            transform: translateY(-50%) scale(0.95);
        }
        .theme-switcher svg {
            transition: transform var(--transition-slow);
        }
        .theme-switcher:hover svg {
            transform: rotate(180deg);
        }
        .main {
            max-width: 480px;
            margin: 40px auto 0 auto;
            padding: 0 10px;
            display: flex;
            flex-direction: column;
            gap: var(--gap-size, 28px);
            animation: fadeIn 0.8s ease-out;
        }
        .card {
            background: var(--card-background);
            border-radius: 14px;
            box-shadow: 0 2px 12px var(--shadow-light);
            padding: var(--card-padding, 26px) 20px 22px 20px;
            display: flex;
            flex-direction: column;
            gap: 18px;
            border: 1px solid var(--border-color);
            transition: all var(--transition-normal);
            animation: fadeIn 0.6s ease-out;
        }
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px var(--shadow-medium);
        }
        .card-title {
            font-size: 1.18rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 6px;
            letter-spacing: 0.2px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--primary-color);
            border-radius: 2px;
            transition: width var(--transition-fast);
        }
        .card:hover .card-title::before {
            width: 8px;
        }
        label {
            display: block;
            margin-top: 12px;
            color: #374151;
            font-weight: 500;
            font-size: 1rem;
        }
        .input-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 4px;
            flex-wrap: wrap;
        }
        input[type="number"], select, input[type="text"] {
            padding: 7px 10px;
            border: 1px solid #cfd8dc;
            border-radius: 6px;
            font-size: 1rem;
            width: 80px;
            min-width: 0;
        }
        #startHour, #startMinute {
            width: 10px;
            text-align: center;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        button {
            margin-top: 18px;
            width: 100%;
            padding: 12px 0;
            background: var(--primary-color);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1.08rem;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px var(--shadow-medium);
        }
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left var(--transition-slow);
        }
        button:hover::before {
            left: 100%;
        }
        button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px var(--shadow-heavy);
        }
        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px var(--shadow-medium);
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        button:disabled::before {
            display: none;
        }
        .result {
            margin-top: 18px;
            background: #e8eaf6;
            border-radius: 8px;
            padding: 14px 10px;
            color: #1a237e;
            font-size: 1.08rem;
            text-align: center;
            box-shadow: 0 1px 4px rgba(26,35,126,0.04);
            border: 1px solid #c5cae9;
        }
        .result-label {
            font-weight: bold;
            color: #283593;
        }
        .footer {
            width: 100%;
            background: #1a237e;
            color: #c5cae9;
            text-align: center;
            padding: 14px 0 10px 0;
            font-size: 0.98rem;
            margin-top: 48px;
            border-radius: 18px 18px 0 0;
        }
        .quick-links {
            background: #f5f7fa;
            border-radius: 12px;
            padding: 18px 14px 14px 14px;
            margin-top: 18px;
            box-shadow: 0 1px 4px rgba(26,35,126,0.03);
            border: 1px solid #e3e6ee;
        }
        .quick-links-title {
            color: #3949ab;
            font-size: 1.08rem;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .quick-links button {
            background: #3949ab;
            color: #fff;
            margin-bottom: 10px;
            width: auto;
            padding: 8px 18px;
            font-size: 1rem;
            border-radius: 6px;
        }
        .quick-links button:hover {
            background: #283593;
        }
        @media (max-width: 600px) {
            .main {
                max-width: 98vw;
                padding: 0 2vw;
            }
            .card {
                padding: 18px 14px 16px 14px;
            }
            .footer {
                font-size: 0.92rem;
                padding: 10px 0 8px 0;
            }
        }
        @media (max-width: 400px) {
            .input-row input[type="number"], .input-row select {
                font-size: 0.95rem;
            }
            #startHour, #startMinute {
                width: 10px;
            }
            .input-row {
                gap: 4px;
            }
        }
        /* Calendar Styles */
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #e3e6ee;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s ease;
            position: relative;
            background: #fff;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .calendar-day:hover {
            background: #f0f4ff;
            border-color: #3949ab;
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(57,73,171,0.15);
        }
        .calendar-day.today {
            background: linear-gradient(135deg, #3949ab, #283593);
            color: #fff;
            border-color: #3949ab;
            box-shadow: 0 3px 8px rgba(57,73,171,0.3);
            font-weight: 600;
        }
        .calendar-day.selected {
            background: linear-gradient(135deg, #388e3c, #2e7d32);
            color: #fff;
            border-color: #388e3c;
            box-shadow: 0 3px 8px rgba(56,142,60,0.3);
            font-weight: 600;
        }
        .calendar-day.has-schedule {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-color: #388e3c;
            box-shadow: 0 2px 6px rgba(56,142,60,0.15);
        }
        .calendar-day.has-schedule::after {
            content: '';
            position: absolute;
            bottom: 4px;
            right: 4px;
            width: 8px;
            height: 8px;
            background: #388e3c;
            border-radius: 50%;
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .calendar-day.other-month {
            color: #ccc;
            background: #f9f9f9;
            border-color: #f0f0f0;
        }
        .calendar-day.other-month:hover {
            background: #f0f0f0;
            border-color: #e0e0e0;
        }
        .calendar-header {
            text-align: center;
            font-weight: 600;
            color: #1a237e;
            padding: 12px 4px;
            font-size: 0.85rem;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 4px;
        }
        /* Enhanced button hover effects */
        #prevMonth:hover, #nextMonth:hover {
            background: #283593 !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15) !important;
        }
        #addScheduleBtn:hover {
            background: #2e7d32 !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15) !important;
        }
        #todayBtn:hover {
            background: #f57c00 !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15) !important;
        }
        /* Schedule modal input enhancements */
        #schedule-modal input[type="number"]:focus,
        #schedule-modal input[type="time"]:focus,
        #schedule-modal input[type="date"]:focus,
        #schedule-modal textarea:focus {
            outline: none;
            border-color: #3949ab;
            box-shadow: 0 0 0 3px rgba(57,73,171,0.1);
            background: #fff;
        }
        #schedule-modal input[type="number"]::-webkit-inner-spin-button,
        #schedule-modal input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        #schedule-modal input[type="number"] {
            -moz-appearance: textfield;
        }
        .contact-sidebar {
            position: fixed;
            top: 0;
            right: 0;
            width: 260px;
            max-width: 95vw;
            height: 100vh;
            background: #fff;
            box-shadow: -2px 0 16px rgba(26,35,126,0.10);
            padding: 28px 18px 18px 18px;
            z-index: 2000;
            overflow-y: auto;
            border-radius: 16px 0 0 16px;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            transition: right 0.3s;
        }
        .contact-sidebar h3 {
            color: #1a237e;
            margin: 0 0 12px 0;
            font-size: 1.15rem;
            font-weight: 600;
            width: 100%;
            text-align: left;
        }
        #contact-list > div {
            border: 1px solid #e3e6ee;
            border-radius: 8px;
            padding: 10px 12px;
            margin-bottom: 10px;
            background: #f7f9fc;
            position: relative;
        }
        #contact-list b {
            color: #3949ab;
        }
        #add-contact-btn {
            margin-top: 10px;
            font-size: 1.2em;
            background: #388e3c;
            color: #fff;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            cursor: pointer;
            display: inline-block;
            margin-bottom: 8px;
        }
        #contact-form {
            display: none;
            margin-top: 12px;
            width: 100%;
        }
        #contact-form input[type="text"] {
            margin-bottom: 6px;
            width: 100%;
            padding: 7px 10px;
            border: 1px solid #cfd8dc;
            border-radius: 6px;
            font-size: 1rem;
        }
        #contact-form button {
            background: #3949ab;
            color: #fff;
            border: none;
            padding: 5px 14px;
            border-radius: 4px;
            margin-left: 8px;
            font-size: 1em;
            font-weight: 500;
            cursor: pointer;
        }
        #contact-form button#cancel-edit-btn {
            background: #aaa;
        }
        .contact-sidebar .contact-actions button {
            background: none;
            border: none;
            cursor: pointer;
            padding: 2px;
        }
        .contact-sidebar .contact-actions svg {
            vertical-align: middle;
        }
        @media (max-width: 700px) {
            .contact-sidebar {
                width: 90vw;
                max-width: 320px;
                height: 100vh;
                left: auto;
                right: 0;
                top: 0;
                bottom: auto;
                border-radius: 16px 0 0 16px;
                box-shadow: -2px 0 16px rgba(26,35,126,0.12);
            }
        }
        /* Enhanced mobile experience */
        @media (max-width: 480px) {
            .input-row {
                flex-direction: column;
                align-items: stretch;
                gap: 8px;
            }
            .input-row input[type="number"],
            .input-row select {
                width: 100%;
                text-align: center;
            }
            .calendar-day {
                aspect-ratio: 1;
                min-height: 40px;
                font-size: 0.85rem;
            }
            .calendar-header {
                padding: 8px 2px;
                font-size: 0.8rem;
            }
            #schedule-modal {
                padding: 0 16px;
            }
            #schedule-modal > div {
                min-width: 280px;
                padding: 24px 20px;
            }
        }

        /* Loading indicators */
        .loading-indicator {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid var(--border-color);
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }

        /* Enhanced focus states for accessibility */
        button:focus,
        input:focus,
        select:focus,
        textarea:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Better touch targets for mobile */
        @media (max-width: 768px) {
            button,
            .calendar-day,
            .theme-switcher {
                min-height: 44px;
                min-width: 44px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <img src="https://images.seeklogo.com/logo-png/55/1/stratus-automation-logo-png_seeklogo-559561.png" alt="Stratus Automation Logo" class="header-logo">
        <span>Stratus Automation</span>
        <span class="header-credit">Page Updated by Syamir</span>
        <button id="theme-switcher" class="theme-switcher" title="Change Theme">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="5"></circle>
                <line x1="12" y1="1" x2="12" y2="3"></line>
                <line x1="12" y1="21" x2="12" y2="23"></line>
                <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                <line x1="1" y1="12" x2="3" y2="12"></line>
                <line x1="21" y1="12" x2="23" y2="12"></line>
                <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
        </button>
    </header>
    <main class="main">
        <section class="card">
            <div class="card-title">Working Hours &amp; End Time</div>
            <form id="workForm" onsubmit="return false;">
                <label>Work Hours:
                    <input type="number" id="workHours" value="9.5" step="0.1" min="0" required>
                </label>
                <label style="display:flex; align-items:center; gap:12px; margin-top:12px;">
                    <span style="min-width:90px;">Start Time:</span>
                    <div class="input-row" style="margin-top:0;">
                        <input type="number" id="startHour" min="1" max="12" value="7" required style="width:48px;"> :
                        <input type="number" id="startMinute" min="0" max="59" value="00" required style="width:48px;">
                        <select id="ampm">
                            <option value="AM" selected>AM</option>
                            <option value="PM">PM</option>
                        </select>
                    </div>
                </label>
                <label>OT Hours:
                    <input type="number" id="otHours" value="1" step="0.1" min="0" required>
                </label>
                <div class="result" id="result">No result yet. Please enter your data and press Calculate.</div>
                <button type="button" onclick="calculateTimes()">Calculate</button>
            </form>
        </section>
        <section class="card">
            <div class="card-title">Overtime Pay Estimator</div>
            <form onsubmit="return false;" style="flex:1 0 auto; display:flex; flex-direction:column; align-items:stretch; padding-top: 10px;">
                <div style="display:flex; align-items:center; gap:10px; margin-bottom: 14px; font-weight:500; color:#333; flex-wrap:nowrap; white-space:nowrap;">
                    <span style="white-space:nowrap;">OT Hours:</span>
                    <input type="number" id="otHoursPay" value="1" step="0.1" min="0" required style="width:90px; flex-shrink:0; height:32px; font-size:1rem; padding:4px 8px; border-radius:6px; border:1px solid #cfd8dc; display:inline-block; vertical-align:middle;">
                    <button id="ot-configure-btn" title="Configure OT Settings" style="background:#3949ab; color:#fff; border:none; border-radius:6px; height:32px; line-height:32px; padding:0 18px; font-size:1rem; font-weight:500; cursor:pointer; transition:background 0.2s; display:inline-block; vertical-align:middle; margin-left:8px; margin-top:-4px;">
                        Configure
                    </button>
                </div>
                <div id="otPayResult-area" style="margin-bottom:14px;">
                    <div style="font-size:0.98em; color:#388e3c; margin-bottom:4px; text-align:left; font-weight:500;">Result:</div>
                    <div id="otPayResult" style="background:#e8f5e9; border:1.5px solid #81c784; border-radius:8px; padding:16px 12px; color:#33691e; font-size:1.08rem; text-align:center; min-height:32px;">No result yet. Please enter your data and press Calculate OT Pay.</div>
                </div>
                <button type="button" onclick="calculateOTPay()" style="background:#388e3c; margin-top: 10px;">Calculate OT Pay</button>
            </form>
        </section>
        <section class="card">
            <div class="card-title">Work Schedule Calendar</div>
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 0 4px;">
                <button id="prevMonth" style="background: #3949ab; color: #fff; border: none; border-radius: 8px; padding: 8px 12px; font-size: 0.9rem; cursor: pointer; transition: background 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); min-width: 80px;">&lt; Previous</button>
                <h3 id="monthYear" style="margin: 0; color: #1a237e; font-size: 1.2rem; font-weight: 600; text-align: center; flex: 1; padding: 0 16px;"></h3>
                <button id="nextMonth" style="background: #3949ab; color: #fff; border: none; border-radius: 8px; padding: 8px 12px; font-size: 0.9rem; cursor: pointer; transition: background 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); min-width: 80px;">Next &gt;</button>
            </div>
            <div id="calendar" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-bottom: 20px; padding: 0 4px;"></div>
            <div style="display: flex; gap: 12px; margin-bottom: 16px; padding: 0 4px;">
                <button id="todayBtn" style="background: #ff9800; color: #fff; border: none; border-radius: 8px; padding: 10px 20px; font-size: 0.95rem; cursor: pointer; transition: background 0.2s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); width: 100%;">Today</button>
            </div>
            <div id="scheduleInfo" style="background: #f8f9fa; border-radius: 12px; padding: 16px; border: 1px solid #e3e6ee; min-height: 80px; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                <div style="color: #666; font-size: 0.9rem; text-align: center;">Select a date to view or add schedule</div>
            </div>
        </section>
        <!-- Schedule Modal -->
        <div id="schedule-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.25); z-index:3000; align-items:center; justify-content:center;">
            <div style="background:#fff; border-radius:16px; padding:32px 28px; min-width:320px; max-width:90vw; box-shadow:0 8px 32px rgba(0,0,0,0.25); display:flex; flex-direction:column; align-items:center; border: 1px solid #e3e6ee;">
                <h3 style='margin-bottom:24px; color:#3949ab; font-size:1.3rem; font-weight:600;'>📅 Add/Edit Schedule</h3>
                <form id="schedule-form" style="width: 100%; display: flex; flex-direction: column; gap: 16px;">
                    <div>
                        <label style="display: block; margin-bottom: 6px; color: #333; font-weight: 500; font-size: 0.95rem;">📆 Date:</label>
                        <input type="date" id="schedule-date" required style="width: 100%; padding: 10px; border: 1px solid #cfd8dc; border-radius: 8px; font-size: 1rem; background: #f8f9fa;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 6px; color: #333; font-weight: 500; font-size: 0.95rem;">⏰ Start Time:</label>
                        <input type="time" id="schedule-start" required style="width: 100%; padding: 10px; border: 1px solid #cfd8dc; border-radius: 8px; font-size: 1rem; background: #f8f9fa;">
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                        <div>
                            <label style="display: block; margin-bottom: 6px; color: #333; font-weight: 500; font-size: 0.95rem;">🕒 Work Hours:</label>
                            <div style="position: relative;">
                                <input type="number" id="schedule-hours" value="9.5" step="0.1" min="0" max="24" required style="width: 100%; padding: 10px 10px 10px 35px; border: 1px solid #cfd8dc; border-radius: 8px; font-size: 1rem; background: #f8f9fa; box-sizing: border-box;">
                                <span style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #666; font-size: 0.9rem; font-weight: 500;">hrs</span>
                            </div>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 6px; color: #333; font-weight: 500; font-size: 0.95rem;">⚡ OT Hours:</label>
                            <div style="position: relative;">
                                <input type="number" id="schedule-ot" value="1" step="0.1" min="0" max="24" required style="width: 100%; padding: 10px 10px 10px 35px; border: 1px solid #cfd8dc; border-radius: 8px; font-size: 1rem; background: #f8f9fa; box-sizing: border-box;">
                                <span style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #666; font-size: 0.9rem; font-weight: 500;">hrs</span>
                            </div>
                        </div>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 6px; color: #333; font-weight: 500; font-size: 0.95rem;">📝 Notes:</label>
                        <textarea id="schedule-notes" placeholder="Optional notes (meetings, tasks, etc.)..." style="width: 100%; padding: 10px; border: 1px solid #cfd8dc; border-radius: 8px; font-size: 1rem; resize: vertical; min-height: 80px; background: #f8f9fa; font-family: inherit;"></textarea>
                    </div>
                    <div style="display:flex; gap:12px; margin-top: 8px;">
                        <button type="submit" style="background:linear-gradient(135deg, #3949ab, #283593); color:#fff; border:none; border-radius:8px; padding:12px 24px; font-size:1em; cursor: pointer; font-weight:500; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s;">💾 Save</button>
                        <button type="button" id="deleteScheduleBtn" style="background:linear-gradient(135deg, #e53935, #c62828); color:#fff; border:none; border-radius:8px; padding:12px 24px; font-size:1em; cursor: pointer; font-weight:500; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s;">🗑️ Delete</button>
                        <button type="button" id="cancelScheduleBtn" style="background:#6c757d; color:#fff; border:none; border-radius:8px; padding:12px 24px; font-size:1em; cursor: pointer; font-weight:500; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s;">❌ Cancel</button>
                    </div>
                </form>
            </div>
        </div>
        <!-- OT Settings Modal -->
        <div id="ot-settings-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.18); z-index:3000; align-items:center; justify-content:center;">
            <div style="background:#fff; border-radius:12px; padding:32px 28px; min-width:260px; max-width:90vw; box-shadow:0 4px 32px rgba(0,0,0,0.18); display:flex; flex-direction:column; align-items:center;">
                <h3 style='margin-bottom:18px; color:#3949ab;'>OT Settings</h3>
                <label style="margin-bottom:10px; color:#333;">OT Rate (RM/hr):
                    <input type="number" id="modalOtRate" value="30" step="1" min="0" style="width:80px; margin-left:8px;">
                </label>
                <label style="margin-bottom:18px; color:#333;">OT Threshold (hrs):
                    <input type="number" id="modalOtThreshold" value="104" step="1" min="0" style="width:80px; margin-left:8px;">
                </label>
                <div style="display:flex; gap:18px;">
                    <button id="saveOtSettings" style="background:#3949ab; color:#fff; border:none; border-radius:6px; padding:7px 24px; font-size:1em;">Save</button>
                    <button id="cancelOtSettings" style="background:#aaa; color:#fff; border:none; border-radius:6px; padding:7px 24px; font-size:1em;">Cancel</button>
                </div>
            </div>
        </div>
        <section class="quick-links">
            <div class="quick-links-title">Quick Links &amp; Resources</div>
            <button onclick="window.open('https://www.renecosystem.com/ESS/MY/sasb/', '_blank')">Open Company ESS Portal</button><br>
            <span style="font-size:0.95em; color:#555;">(Clock-in, Payslip, OT, Leave, etc.)</span>
            <hr style="margin: 18px 0 12px 0; border: none; border-top: 1px solid #e0e0e0;">
            <button onclick="window.open('https://stratusautomation.sharepoint.com/sites/CRBChangeReviewBoard/', '_blank')">Open CRB Submission Portal</button><br>
            <span style="font-size:0.95em; color:#555;">(Submit Change Review Board requests)</span>
        </section>
    </main>
    <footer class="footer">
        &copy; 2024 Stratus Automation. All rights reserved.
    </footer>
    <button id="phone-float-btn"
        style="position:fixed; right:24px; bottom:40px; background:#43a047; color:#fff; border:none; border-radius:50%; width:56px; height:56px; font-size:2rem; box-shadow:0 2px 8px rgba(0,0,0,0.15); cursor:pointer; z-index:1000; display:flex; align-items:center; justify-content:center; padding:0;"
        title="Show Contacts">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="16" cy="16" r="16" fill="#43a047"/>
            <path d="M22.5 20.5c-1.5 0-3-.25-4.5-.75-1.5-.5-2.75-1.25-3.75-2.25s-1.75-2.25-2.25-3.75c-.5-1.5-.75-3-.75-4.5 0-.5.2-.9.6-1.2l2.2-2.2c.3-.3.7-.3 1 0l2.2 2.2c.3.3.3.7 0 1l-1.1 1.1c.2.6.5 1.2.9 1.7.4.5.9.9 1.4 1.2l1.1-1.1c.3-.3.7-.3 1 0l2.2 2.2c.3.3.3.7 0 1l-2.2 2.2c-.3.3-.7.3-1 0l-1.1-1.1c-.3.3-.7.3-1 0-.3-.3-.3-.7 0-1l1.1-1.1c-.3-.3-.7-.3-1 0l-2.2 2.2c-.3.3-.3.7 0 1l2.2 2.2c.3.3.7.3 1 0l1.1-1.1c.3-.3.7-.3 1 0l2.2 2.2c.3.3.3.7 0 1l-2.2 2.2c-.3.3-.7.3-1 0z" fill="#fff"/>
        </svg>
    </button>
    <div id="contact-overlay" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.18); z-index:1999;"></div>
    <div class="contact-sidebar" id="contact-sidebar" style="display:none;">
        <h3>Supplier Contact</h3>
        <div id="contact-list" style="display:none;"></div>
        <button id="add-contact-btn">+</button>
        <form id="contact-form">
            <input type="text" id="contact-pic" placeholder="PIC Name" required>
            <input type="text" id="contact-company" placeholder="Company" required>
            <input type="text" id="contact-brand" placeholder="Brand" required>
            <input type="text" id="contact-number" placeholder="Contact Number" required>
            <input type="hidden" id="contact-edit-index">
            <button type="submit">Save</button>
            <button type="button" id="cancel-edit-btn">Cancel</button>
        </form>
    </div>
    <script>
        // Calendar functionality
        let currentDate = new Date(2025, 7, 7); // August 7, 2025 (month is 0-indexed, so 7 = August)
        let selectedDate = new Date(2025, 7, 7);
        let schedules = JSON.parse(localStorage.getItem('workSchedules') || '{}');

        function renderCalendar() {
            const calendar = document.getElementById('calendar');
            const monthYear = document.getElementById('monthYear');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Malaysian date format
            monthYear.textContent = new Date(year, month).toLocaleDateString('ms-MY', { 
                month: 'long', 
                year: 'numeric' 
            });
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            calendar.innerHTML = '';
            
            // Add day headers - Malaysian format (Ahad = Sunday)
            const days = ['Aha', 'Isn', 'Sel', 'Rab', 'Kha', 'Jum', 'Sab'];
            days.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-header';
                dayHeader.textContent = day;
                calendar.appendChild(dayHeader);
            });
            
            // Add calendar days
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = date.getDate();
                
                const dateString = date.toISOString().split('T')[0];
                const today = new Date(2025, 7, 7).toISOString().split('T')[0]; // August 7, 2025
                const selectedDateString = selectedDate.toISOString().split('T')[0];
                
                if (dateString === today) {
                    dayElement.classList.add('today');
                }
                if (dateString === selectedDateString) {
                    dayElement.classList.add('selected');
                }
                if (date.getMonth() !== month) {
                    dayElement.classList.add('other-month');
                }
                if (schedules[dateString]) {
                    dayElement.classList.add('has-schedule');
                }
                
                dayElement.onclick = () => selectDate(date);
                calendar.appendChild(dayElement);
            }
        }

        function selectDate(date) {
            selectedDate = date;
            renderCalendar();
            showScheduleInfo(date);
        }

        function showScheduleInfo(date) {
            const scheduleInfo = document.getElementById('scheduleInfo');
            const dateString = date.toISOString().split('T')[0];
            const schedule = schedules[dateString];
            
            if (schedule) {
                const endTime = calculateEndTime(schedule.startTime, schedule.workHours);
                const otEndTime = calculateEndTime(schedule.startTime, schedule.workHours + schedule.otHours);
                
                scheduleInfo.innerHTML = `
                    <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #e3e6ee;">
                        <strong style="color: #1a237e; font-size: 1.1rem;">📅 ${date.toLocaleDateString('ms-MY', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</strong>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                        <div style="background: #f8f9fa; padding: 8px; border-radius: 6px; border-left: 3px solid #3949ab;">
                            <div style="font-weight: 600; color: #3949ab; font-size: 0.85rem;">⏰ START</div>
                            <div style="font-size: 1.1rem; font-weight: 600;">${schedule.startTime}</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 8px; border-radius: 6px; border-left: 3px solid #388e3c;">
                            <div style="font-weight: 600; color: #388e3c; font-size: 0.85rem;">🏁 END</div>
                            <div style="font-size: 1.1rem; font-weight: 600;">${endTime}</div>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 12px;">
                        <div style="background: #f8f9fa; padding: 8px; border-radius: 6px; border-left: 3px solid #ff9800;">
                            <div style="font-weight: 600; color: #ff9800; font-size: 0.85rem;">🕒 WORK HOURS</div>
                            <div style="font-size: 1.1rem; font-weight: 600;">${schedule.workHours}h</div>
                        </div>
                        <div style="background: #f8f9fa; padding: 8px; border-radius: 6px; border-left: 3px solid #e53935;">
                            <div style="font-weight: 600; color: #e53935; font-size: 0.85rem;">⚡ OT HOURS</div>
                            <div style="font-size: 1.1rem; font-weight: 600;">${schedule.otHours}h</div>
                        </div>
                    </div>
                    <div style="background: #f8f9fa; padding: 8px; border-radius: 6px; border-left: 3px solid #9c27b0; margin-bottom: 12px;">
                        <div style="font-weight: 600; color: #9c27b0; font-size: 0.85rem;">🌙 OT END</div>
                        <div style="font-size: 1.1rem; font-weight: 600;">${otEndTime}</div>
                    </div>
                    ${schedule.notes ? `<div style="background: #fff; padding: 12px; border-radius: 8px; border: 1px solid #e3e6ee; margin-bottom: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.05);"><div style="font-weight: 600; color: #3949ab; margin-bottom: 4px;">📝 Notes:</div><div style="color: #333; line-height: 1.4;">${schedule.notes}</div></div>` : ''}
                    <div style="display: flex; gap: 8px;">
                        <button onclick="editSchedule('${dateString}')" style="background: linear-gradient(135deg, #3949ab, #283593); color: #fff; border: none; border-radius: 8px; padding: 8px 16px; font-size: 0.9rem; cursor: pointer; font-weight: 500; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s; flex: 1;">✏️ Edit Schedule</button>
                        <button onclick="copyScheduleToCalculator('${dateString}')" style="background: linear-gradient(135deg, #ff9800, #f57c00); color: #fff; border: none; border-radius: 8px; padding: 8px 16px; font-size: 0.9rem; cursor: pointer; font-weight: 500; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s;">📋 Copy to Calculator</button>
                    </div>
                `;
            } else {
                scheduleInfo.innerHTML = `
                    <div style="margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #e3e6ee;">
                        <strong style="color: #1a237e; font-size: 1.1rem;">📅 ${date.toLocaleDateString('ms-MY', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</strong>
                    </div>
                    <div style="text-align: center; padding: 20px 0;">
                        <div style="color: #666; font-size: 1rem; margin-bottom: 16px;">📝 No schedule for this date</div>
                        <button onclick="addSchedule('${dateString}')" style="background: linear-gradient(135deg, #388e3c, #2e7d32); color: #fff; border: none; border-radius: 8px; padding: 12px 24px; font-size: 1rem; cursor: pointer; font-weight: 500; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: all 0.2s;">➕ Add Schedule</button>
                    </div>
                `;
            }
        }

        function calculateEndTime(startTime, totalHours) {
            const [hours, minutes] = startTime.split(':').map(Number);
            const totalMinutes = hours * 60 + minutes + Math.round(totalHours * 60);
            const endHour = Math.floor(totalMinutes / 60) % 24;
            const endMinute = totalMinutes % 60;
            return `${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}`;
        }

        function addSchedule(dateString) {
            const modal = document.getElementById('schedule-modal');
            const form = document.getElementById('schedule-form');
            const dateInput = document.getElementById('schedule-date');
            const deleteBtn = document.getElementById('deleteScheduleBtn');
            
            dateInput.value = dateString;
            deleteBtn.style.display = 'none';
            form.reset();
            
            modal.style.display = 'flex';
        }

        function editSchedule(dateString) {
            const modal = document.getElementById('schedule-modal');
            const form = document.getElementById('schedule-form');
            const schedule = schedules[dateString];
            const deleteBtn = document.getElementById('deleteScheduleBtn');
            
            document.getElementById('schedule-date').value = dateString;
            document.getElementById('schedule-start').value = schedule.startTime;
            document.getElementById('schedule-hours').value = schedule.workHours;
            document.getElementById('schedule-ot').value = schedule.otHours;
            document.getElementById('schedule-notes').value = schedule.notes || '';
            
            deleteBtn.style.display = 'inline-block';
            modal.style.display = 'flex';
        }

        // Calendar event listeners
        document.getElementById('prevMonth').onclick = () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        };

        document.getElementById('nextMonth').onclick = () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        };

        document.getElementById('todayBtn').onclick = () => {
            const today = new Date(2025, 7, 7); // August 7, 2025
            currentDate = new Date(today);
            selectedDate = new Date(today);
            renderCalendar();
            showScheduleInfo(selectedDate);
        };

        // Enhanced function to copy schedule to calculator
        window.copyScheduleToCalculator = function(dateString) {
            const schedule = schedules[dateString];
            if (schedule) {
                // Parse start time to get hours and minutes
                const [hours, minutes] = schedule.startTime.split(':').map(Number);
                let hour12 = hours % 12;
                if (hour12 === 0) hour12 = 12;
                const ampm = hours >= 12 ? 'PM' : 'AM';
                
                // Update calculator fields
                document.getElementById('workHours').value = schedule.workHours;
                document.getElementById('otHours').value = schedule.otHours;
                document.getElementById('startHour').value = hour12;
                document.getElementById('startMinute').value = minutes.toString().padStart(2, '0');
                document.getElementById('ampm').value = ampm;
                
                // Calculate and show results
                calculateTimes();
                
                // Show success message
                const resultDiv = document.getElementById('result');
                const originalContent = resultDiv.innerHTML;
                resultDiv.innerHTML = `<div style="color: #388e3c; font-weight: 600;">✅ Schedule copied to calculator!</div>` + originalContent;
                
                // Scroll to calculator section
                document.querySelector('.card').scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Clear success message after 3 seconds
                setTimeout(() => {
                    resultDiv.innerHTML = originalContent;
                }, 3000);
            }
        };

        // Schedule modal event listeners
        document.getElementById('schedule-form').onsubmit = (e) => {
            e.preventDefault();
            const dateString = document.getElementById('schedule-date').value;
            const startTime = document.getElementById('schedule-start').value;
            const workHours = parseFloat(document.getElementById('schedule-hours').value);
            const otHours = parseFloat(document.getElementById('schedule-ot').value);
            const notes = document.getElementById('schedule-notes').value;
            
            schedules[dateString] = {
                startTime,
                workHours,
                otHours,
                notes
            };
            
            localStorage.setItem('workSchedules', JSON.stringify(schedules));
            document.getElementById('schedule-modal').style.display = 'none';
            renderCalendar();
            showScheduleInfo(selectedDate);
        };

        document.getElementById('deleteScheduleBtn').onclick = () => {
            const dateString = document.getElementById('schedule-date').value;
            if (confirm('Delete this schedule?')) {
                delete schedules[dateString];
                localStorage.setItem('workSchedules', JSON.stringify(schedules));
                document.getElementById('schedule-modal').style.display = 'none';
                renderCalendar();
                showScheduleInfo(selectedDate);
            }
        };

        document.getElementById('cancelScheduleBtn').onclick = () => {
            document.getElementById('schedule-modal').style.display = 'none';
        };

        // Initialize calendar
        document.addEventListener('DOMContentLoaded', function() {
            renderCalendar();
            showScheduleInfo(selectedDate);
            initializeTheme();
            addLoadingStates();
        });

        // Theme management
        function initializeTheme() {
            const savedTheme = localStorage.getItem('selectedTheme') || 'default';
            applyTheme(savedTheme);
            
            const themeSwitcher = document.getElementById('theme-switcher');
            themeSwitcher.addEventListener('click', function() {
                const themes = ['default', 'corporate', 'modern', 'warm'];
                const currentTheme = document.body.className.replace('theme-', '') || 'default';
                const currentIndex = themes.indexOf(currentTheme);
                const nextIndex = (currentIndex + 1) % themes.length;
                const nextTheme = themes[nextIndex];
                
                applyTheme(nextTheme);
                localStorage.setItem('selectedTheme', nextTheme);
                
                // Add animation to theme switcher
                this.style.transform = 'translateY(-50%) scale(1.2) rotate(180deg)';
                setTimeout(() => {
                    this.style.transform = 'translateY(-50%) scale(1) rotate(0deg)';
                }, 300);
            });
        }

        function applyTheme(themeName) {
            document.body.className = themeName === 'default' ? '' : `theme-${themeName}`;
            
            // Update theme switcher icon based on theme
            const themeSwitcher = document.getElementById('theme-switcher');
            const icon = themeSwitcher.querySelector('svg');
            
            // Add theme transition animation
            document.body.style.transition = 'background-color 0.3s ease, color 0.3s ease';
            setTimeout(() => {
                document.body.style.transition = '';
            }, 300);
        }

        // Loading states
        function addLoadingStates() {
            // Add loading animation to cards on initial load
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
                card.classList.add('fade-in');
            });
            
            // Add loading state to buttons
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    if (!this.disabled) {
                        this.classList.add('loading');
                        setTimeout(() => {
                            this.classList.remove('loading');
                        }, 1000);
                    }
                });
            });
        }

        // Enhanced animations for calendar
        function renderCalendar() {
            const calendar = document.getElementById('calendar');
            const monthYear = document.getElementById('monthYear');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            // Malaysian date format
            monthYear.textContent = new Date(year, month).toLocaleDateString('ms-MY', { 
                month: 'long', 
                year: 'numeric' 
            });
            
            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            calendar.innerHTML = '';
            
            // Add day headers - Malaysian format (Ahad = Sunday)
            const days = ['Aha', 'Isn', 'Sel', 'Rab', 'Kha', 'Jum', 'Sab'];
            days.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'calendar-header fade-in';
                dayHeader.textContent = day;
                calendar.appendChild(dayHeader);
            });
            
            // Add calendar days with staggered animation
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day fade-in';
                dayElement.textContent = date.getDate();
                dayElement.style.animationDelay = `${i * 0.02}s`;
                
                const dateString = date.toISOString().split('T')[0];
                const today = new Date(2025, 7, 7).toISOString().split('T')[0]; // August 7, 2025
                const selectedDateString = selectedDate.toISOString().split('T')[0];
                
                if (dateString === today) {
                    dayElement.classList.add('today');
                }
                if (dateString === selectedDateString) {
                    dayElement.classList.add('selected');
                }
                if (date.getMonth() !== month) {
                    dayElement.classList.add('other-month');
                }
                if (schedules[dateString]) {
                    dayElement.classList.add('has-schedule');
                }
                
                dayElement.onclick = () => selectDate(date);
                calendar.appendChild(dayElement);
            }
        }

        function formatTime(hour24, minute) {
            let ampm = hour24 >= 12 ? 'PM' : 'AM';
            let hour12 = hour24 % 12;
            if (hour12 === 0) hour12 = 12;
            return `${hour12.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')} ${ampm}`;
        }
        function calculateTimes() {
            const workHours = parseFloat(document.getElementById('workHours').value);
            let hour = parseInt(document.getElementById('startHour').value, 10);
            let minute = parseInt(document.getElementById('startMinute').value, 10);
            const ampm = document.getElementById('ampm').value;
            const otHours = parseFloat(document.getElementById('otHours').value);
            if (ampm === 'PM' && hour !== 12) hour += 12;
            if (ampm === 'AM' && hour === 12) hour = 0;
            let totalMinutes = hour * 60 + minute + Math.round(workHours * 60);
            let endHour = Math.floor(totalMinutes / 60) % 24;
            let endMinute = totalMinutes % 60;
            let otMinutes = totalMinutes + Math.round(otHours * 60);
            let otHour = Math.floor(otMinutes / 60) % 24;
            let otMinute = otMinutes % 60;
            document.getElementById('result').innerHTML =
                `<b>End Work Time:</b> ${formatTime(endHour, endMinute)}<br>` +
                `<b>End OT Time:</b> ${formatTime(otHour, otMinute)}`;
        }
        // OT Settings Modal Logic (restored to previous functionality)
        const otGearBtn = document.getElementById('ot-configure-btn');
        const otSettingsModal = document.getElementById('ot-settings-modal');
        const modalOtRate = document.getElementById('modalOtRate');
        const modalOtThreshold = document.getElementById('modalOtThreshold');
        const saveOtSettings = document.getElementById('saveOtSettings');
        const cancelOtSettings = document.getElementById('cancelOtSettings');
        let otRateValue = parseFloat(modalOtRate.value) || 30;
        let otThresholdValue = parseFloat(modalOtThreshold.value) || 104;
        otGearBtn.onclick = function() {
            modalOtRate.value = otRateValue;
            modalOtThreshold.value = otThresholdValue;
            otSettingsModal.style.display = 'flex';
        };
        cancelOtSettings.onclick = function() {
            otSettingsModal.style.display = 'none';
        };
        saveOtSettings.onclick = function() {
            otRateValue = parseFloat(modalOtRate.value) || 30;
            otThresholdValue = parseFloat(modalOtThreshold.value) || 104;
            otSettingsModal.style.display = 'none';
        };
        function calculateOTPay() {
            const otRate = otRateValue;
            const otHours = parseFloat(document.getElementById('otHoursPay').value);
            const threshold = otThresholdValue;
            if (isNaN(otRate) || isNaN(otHours)) {
                document.getElementById('otPayResult').innerHTML = '<span style="color:#b71c1c;">Please enter valid OT hours and rate.</span>';
                return;
            }
            const otPay = otRate * otHours;
            const otLeft = threshold - otHours;
            document.getElementById('otPayResult').innerHTML =
                `<b>Total OT Pay:</b> RM${otPay.toFixed(2)}<br>` +
                `<b>OT Hours Left (Threshold ${threshold}):</b> ${otLeft < 0 ? 0 : otLeft.toFixed(2)} hrs`;
        }
        // Loan Part Supplier Contact Section
        function renderContacts() {
            const list = document.getElementById('contact-list');
            const contacts = JSON.parse(localStorage.getItem('loanContacts') || '[]');
            if (contacts.length === 0) {
                list.innerHTML = '<div style="color:#888;">No contacts saved.</div>';
                return;
            }
            list.innerHTML = contacts.map((c, i) =>
                `<div><div>
                        <b>PIC:</b> ${c.pic} <br>
                        <b>Company:</b> ${c.company} <br>
                        <b>Brand:</b> ${c.brand} <br>
                        <b>Contact:</b> <span id='contact-num-${i}' style='user-select:all;'>${c.number}</span>
                    </div>
                    <div class='contact-actions' style='display:flex; justify-content:center; gap:18px; margin-top:10px;'>
                        <button onclick='copyContactNumber(${i})' title='Copy Number'>
                            <svg width='24' height='24' viewBox='0 0 24 24' fill='none'>
                                <rect x='6' y='6' width='12' height='14' rx='2' fill='#888'/>
                                <rect x='4' y='4' width='12' height='14' rx='2' stroke='#888' stroke-width='1.5' fill='none'/>
                            </svg>
                        </button>
                        <button onclick='editContact(${i})' title='Edit'>
                            <svg width='24' height='24' viewBox='0 0 24 24' fill='none'>
                                <path d='M5 18.5V20h1.5l9.1-9.1-1.5-1.5L5 18.5z' fill='#ffa726'/>
                                <path d='M17.7 8.04c.2-.2.2-.51 0-.71l-1-1a.5.5 0 0 0-.71 0l-1.09 1.09 1.5 1.5 1.09-1.09z' fill='#ffa726'/>
                            </svg>
                        </button>
                        <button onclick='deleteContact(${i})' title='Delete'>
                            <svg width='24' height='24' viewBox='0 0 24 24' fill='none'>
                                <path d='M6 7h12' stroke='#e53935' stroke-width='2' stroke-linecap='round'/>
                                <rect x='9' y='10' width='1.5' height='7' rx='.75' fill='#e53935'/>
                                <rect x='13.5' y='10' width='1.5' height='7' rx='.75' fill='#e53935'/>
                                <rect x='5' y='7' width='14' height='2' rx='1' fill='#e53935'/>
                                <rect x='8' y='4' width='8' height='2' rx='1' fill='#e53935'/>
                                <rect x='7' y='9' width='10' height='10' rx='2' stroke='#e53935' stroke-width='1.5' fill='none'/>
                            </svg>
                        </button>
                    </div>
                </div>`
            ).join('');
        }
        const phoneBtn = document.getElementById('phone-float-btn');
        const sidebar = document.getElementById('contact-sidebar');
        const overlay = document.getElementById('contact-overlay');
        phoneBtn.onclick = function() {
            sidebar.style.display = 'flex';
            overlay.style.display = 'block';
            renderContacts();
            document.getElementById('contact-list').style.display = 'block';
            document.getElementById('add-contact-btn').style.display = 'inline-block';
        };
        overlay.onclick = function(e) {
            sidebar.style.display = 'none';
            overlay.style.display = 'none';
            document.getElementById('contact-form').style.display = 'none';
        };
        document.getElementById('add-contact-btn').onclick = function() {
            document.getElementById('contact-form').style.display = 'block';
            this.style.display = 'none';
            document.getElementById('contact-form').reset();
            document.getElementById('contact-edit-index').value = '';
        };
        document.getElementById('contact-form').onsubmit = function(e) {
            e.preventDefault();
            const pic = document.getElementById('contact-pic').value.trim();
            const company = document.getElementById('contact-company').value.trim();
            const brand = document.getElementById('contact-brand').value.trim();
            const number = document.getElementById('contact-number').value.trim();
            const editIndex = document.getElementById('contact-edit-index').value;
            if (!pic || !company || !brand || !number) return;
            let contacts = JSON.parse(localStorage.getItem('loanContacts') || '[]');
            if (editIndex !== '') {
                contacts[editIndex] = { pic, company, brand, number };
            } else {
                contacts.push({ pic, company, brand, number });
            }
            localStorage.setItem('loanContacts', JSON.stringify(contacts));
            renderContacts();
            document.getElementById('contact-form').reset();
            document.getElementById('contact-form').style.display = 'none';
            document.getElementById('add-contact-btn').style.display = 'inline-block';
        };
        document.getElementById('cancel-edit-btn').onclick = function() {
            document.getElementById('contact-form').reset();
            document.getElementById('contact-form').style.display = 'none';
            document.getElementById('add-contact-btn').style.display = 'inline-block';
        };
        if (!document.getElementById('edit-modal')) {
            const modal = document.createElement('div');
            modal.id = 'edit-modal';
            modal.style.display = 'none';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100vw';
            modal.style.height = '100vh';
            modal.style.background = 'rgba(0,0,0,0.25)';
            modal.style.zIndex = '3000';
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.innerHTML = `
                <div style="background:#fff; border-radius:12px; padding:32px 28px; min-width:280px; max-width:90vw; box-shadow:0 4px 32px rgba(0,0,0,0.18); display:flex; flex-direction:column; align-items:center;">
                    <h3 style='margin-bottom:18px; color:#2d3a4a;'>Edit Contact</h3>
                    <form id='edit-contact-form' style='width:100%; display:flex; flex-direction:column; gap:10px;'>
                        <input type='text' id='edit-pic' placeholder='PIC Name' required style='padding:7px 10px; border-radius:6px; border:1px solid #bbb;'>
                        <input type='text' id='edit-company' placeholder='Company' required style='padding:7px 10px; border-radius:6px; border:1px solid #bbb;'>
                        <input type='text' id='edit-brand' placeholder='Brand' required style='padding:7px 10px; border-radius:6px; border:1px solid #bbb;'>
                        <input type='text' id='edit-number' placeholder='Contact Number' required style='padding:7px 10px; border-radius:6px; border:1px solid #bbb;'>
                        <div style='display:flex; justify-content:center; gap:18px; margin-top:10px;'>
                            <button type='submit' style='background:#3949ab; color:#fff; border:none; border-radius:6px; padding:7px 24px; font-size:1em;'>Save</button>
                            <button type='button' id='cancel-edit-modal' style='background:#aaa; color:#fff; border:none; border-radius:6px; padding:7px 24px; font-size:1em;'>Cancel</button>
                        </div>
                    </form>
                </div>
            `;
            document.body.appendChild(modal);
        }
        window.editContact = function(index) {
            const contacts = JSON.parse(localStorage.getItem('loanContacts') || '[]');
            const c = contacts[index];
            const modal = document.getElementById('edit-modal');
            modal.style.display = 'flex';
            document.getElementById('edit-pic').value = c.pic;
            document.getElementById('edit-company').value = c.company;
            document.getElementById('edit-brand').value = c.brand;
            document.getElementById('edit-number').value = c.number;
            document.getElementById('edit-contact-form').onsubmit = function(e) {
                e.preventDefault();
                const pic = document.getElementById('edit-pic').value.trim();
                const company = document.getElementById('edit-company').value.trim();
                const brand = document.getElementById('edit-brand').value.trim();
                const number = document.getElementById('edit-number').value.trim();
                if (!pic || !company || !brand || !number) return;
                contacts[index] = { pic, company, brand, number };
                localStorage.setItem('loanContacts', JSON.stringify(contacts));
                renderContacts();
                modal.style.display = 'none';
            };
            document.getElementById('cancel-edit-modal').onclick = function() {
                document.getElementById('edit-contact-form').reset();
                modal.style.display = 'none';
            };
        };
        window.deleteContact = function(index) {
            let contacts = JSON.parse(localStorage.getItem('loanContacts') || '[]');
            const c = contacts[index];
            const msg = `Delete this contact?\n\nPIC: ${c.pic}\nCompany: ${c.company}\nBrand: ${c.brand}\nContact: ${c.number}`;
            if (confirm(msg)) {
                contacts.splice(index, 1);
                localStorage.setItem('loanContacts', JSON.stringify(contacts));
                renderContacts();
            }
        };
        window.copyContactNumber = function(index) {
            const contacts = JSON.parse(localStorage.getItem('loanContacts') || '[]');
            const number = contacts[index].number;
            navigator.clipboard.writeText(number).then(() => {
                // Optionally, show a copied message
            });
        };
        window.addEventListener('DOMContentLoaded', function() {
            renderContacts();
            var modal = document.getElementById('edit-modal');
            if (modal) modal.style.display = 'none';
        });
    </script>
</body>
</html>
